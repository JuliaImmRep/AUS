# AUS

## Overview
Antibody upstream sequence (AUS) repository contains all key python scripts for reproducing results in ***"Antibody Upstream Sequence Diversity and Its Biological Implications Revealed by Repertoire Sequencing"*** (doi: https://doi.org/10.1101/2020.09.02.280396). These scripts include those employed for AUS identification and filtration and those for characterizing the identified AUS from different species. 


## Table of contents
* [AUS identification](#aus-identification)
* [Characterization analyses](#characterization-analyses)


## AUS identification

### AUS identification for non-human species
`nonhuman_aus_identification.py cloneFl alignFl primer sample leader_imgt.fasta utr_imgt.fasta isotype`
The script, `nonhuman_aus_identification.py`, accepts seven commandline parameters and outputs a single file recording tge candidate AUSs for each sample.
The comandline parameters include,
`cloneFl`: clone file output by MiXCR
`alignFl`: alignment file output by MiXCR
`primer`: primer sequence upstream AUS
`sample`: sample id
`leader_imgt.fasta`: leader reference sequences from IMGT (in fasta format)
`utr_imgt.fasta`: UTR reference sequences from IMGT (in fasta format)
`isotype`: isotype
The output file, (i.e. `sample.upstream.sequence.fasta`), looks like,
```
Allele	Group	Flag	Rank	alleleCount	novelCount	Sequence	leaderStart	seqFreq	cloneFreq	readFreq	seqIdentity	SampleId	Isotype	seq_ref	IMGT_leader	IMGT_utr	leader	utr	ATG_Substring
IGHV1S2*01	Homozygote	upstream	1	NA	366	ACATCACACAACAATCACATCCCTCCCCTACAGAAGTCCCCAGAGCACAGCACCTCACCATGGACTGGACATGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGCGCCCACTCC	59	0.177595628415	65	422	0.9873003487935349	MFS01	IgM	ACATCACACAACAATCACATCCCTCCCCTACAGAAGTCCCCAGAGCACAGCACCTCACCATGGACTGGACATGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGCGCCCACTCC_IGHV1S2*01	1	2	ATGGACTGGACATGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGCGCCCACTCC	ACATCACACAACAATCACATCCCTCCCCTACAGAAGTCCCCAGAGCACAGCACCTCACC	GCACAGCACCTCACCATGGACTGGACATGGAGG
IGHV1S2*01	Homozygote	upstream	2	NA	366	ATCACACAACAACCACATCCCTCCCCTAAAGAAGCCCCAGAGCACAGCATCTCACCATGGACTGGACCTGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGTGCCCACTCC	56	0.106557377049	39	246	0.9752896547841291	MFS01	IgM	ATCACACAACAACCACATCCCTCCCCTAAAGAAGCCCCAGAGCACAGCATCTCACCATGGACTGGACCTGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGTGCCCACTCC_IGHV1S2*01	1	2	ATGGACTGGACCTGGAGGATCCTCCTCTTGGTGGCAGCAGCTACAGGTGCCCACTCC	ATCACACAACAACCACATCCCTCCCCTAAAGAAGCCCCAGAGCACAGCATCTCACC	GCACAGCATCTCACCATGGACTGGACCTGGAGG
IGHV4S9*01	Homozygote	upstream	1	NA	113	ATGCTCTCTGAGAGTCACGGACATCCTGTGCAAGAACATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC	37 0.106194690265	12	46	0.9230814293732988	MFS01	IgM	ATGCTCTCTGAGAGTCACGGACATCCTGTGCAAGAACATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC_IGHV4S9*01	1	2	ATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC	ATGCTCTCTGAGAGTCACGGACATCCTGTGCAAGAAC	ATCCTGTGCAAGAACATGAAGCATCTGTGGTTC
IGHV4S9*01	Homozygote	upstream	2	NA	113	CTCTCTGAGAGTCACGGACATCCTGTGCAAGAACATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC	34 0.0530973451327	6	21	0.9261943983759199	MFS01	IgM	CTCTCTGAGAGTCACGGACATCCTGTGCAAGAACATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC_IGHV4S9*01	1	2	ATGAAGCATCTGTGGTTCTTCCTCCTCCTGGTGGCAGCTCCCAGATGGGTCCTGTCC	CTCTCTGAGAGTCACGGACATCCTGTGCAAGAAC	ATCCTGTGCAAGAACATGAAGCATCTGTGGTTC
IGHV3S4*01	Homozygote	upstream	1	NA	175	AGCTCTGGGAGAGGAGCCCCAGTCTGGGATTCCCAGGAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAGCCATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTCTTTTAAAAGGTGTGCAGTGT	79	0.188571428571	33	115	0.9402597774363581	MFS01	IgM	AGCTCTGGGAGAGGAGCCCCAGTCTGGGATTCCCAGGAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAGCCATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTCTTTTAAAAGGTGTGCAGTGT_IGHV3S4*01	1	2	ATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTCTTTTAAAAGGTGTGCAGTGT  AGCTCTGGGAGAGGAGCCCCAGTCTGGGATTCCCAGGAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAGCC	CACAGACCACCAGCCATGGAGTTGGGGCTGAGC
IGHV3S4*01	Homozygote	upstream	2	NA	175	AGCTCTGGGAGAGGAGGCCCAGCCTGGGATTCGCAGCAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAACCATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTGTTTTAAAAGGTGTCCAGTGT	79	0.131428571429	23	25	0.9246035911829197	MFS01	IgM	AGCTCTGGGAGAGGAGGCCCAGCCTGGGATTCGCAGCAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAACCATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTGTTTTAAAAGGTGTCCAGTGT_IGHV3S4*01	1	2	ATGGAGTTGGGGCTGAGCTGGGTTTTCCTTGTTGCTGTTTTAAAAGGTGTCCAGTGT  AGCTCTGGGAGAGGAGGCCCAGCCTGGGATTCGCAGCAGTTTCCACTTGGTGACCAGCACTGAACACAGACCACCAACC	CACAGACCACCAACCATGGAGTTGGGGCTGAGC
```


## Characterization analyses



## Dependencies
In-house scripts above were written in Python (v3.7). Note that a series of modules are required, which include `pandas`, `numpy`, `csv`, `seaborn`, `matplotlib`, `warnings`, `multiprocessing`, `argparse`, `biopython`, `pyforest`, `subprocess`, `Levenshtein`, `scipy`, `sklearn`, `itertools`, and `mpl_toolkits`.

## Others
For the scripts implementing other analyses in the MS, please contact the Lead Contact, Zhenhai Zhang (zhenhaismu@163.com).